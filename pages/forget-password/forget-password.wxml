<!--pages/forget-password/forget-password.wxml-->
<view class="forget-container">
  <!-- 顶部装饰 -->
  <view class="header-decoration">
    <view class="decoration-circle circle-1"></view>
    <view class="decoration-circle circle-2"></view>
  </view>

  <!-- 头部 -->
  <view class="header-section">
    <view class="title">{{step === 1 ? '找回密码' : '重置密码'}}</view>
    <view class="subtitle">{{step === 1 ? '验证您的手机号码' : '设置新的登录密码'}}</view>
  </view>

  <!-- 步骤1: 验证手机号 -->
  <view class="form-section" wx:if="{{step === 1}}">
    <!-- 手机号 -->
    <view class="input-group">
      <view class="input-wrapper">
        <view class="input-icon">
          <l-icon name="phone" size="40" color="#999"></l-icon>
        </view>
        <input 
          class="input-field" 
          type="number" 
          placeholder="请输入手机号" 
          value="{{phone}}"
          bindinput="onPhoneInput"
          maxlength="11"
        />
      </view>
    </view>

    <!-- 验证码 -->
    <view class="input-group">
      <view class="input-wrapper">
        <view class="input-icon">
          <l-icon name="message" size="40" color="#999"></l-icon>
        </view>
        <input 
          class="input-field" 
          type="number" 
          placeholder="请输入验证码" 
          value="{{smsCode}}"
          bindinput="onSmsCodeInput"
          maxlength="6"
        />
        <view 
          class="sms-btn {{countdown > 0 ? 'disabled' : ''}}" 
          bindtap="sendSmsCode"
        >
          {{countdown > 0 ? countdown + 's' : '发送验证码'}}
        </view>
      </view>
    </view>

    <!-- 验证按钮 -->
    <view class="btn-wrapper">
      <l-button 
        class="primary-btn"
        type="success"
        size="large"
        loading="{{loading}}"
        bind:lintap="verifyPhone"
      >
        {{loading ? '验证中...' : '下一步'}}
      </l-button>
    </view>
  </view>

  <!-- 步骤2: 重置密码 -->
  <view class="form-section" wx:else>
    <!-- 新密码 -->
    <view class="input-group">
      <view class="input-wrapper">
        <view class="input-icon">
          <l-icon name="lock" size="40" color="#999"></l-icon>
        </view>
        <input 
          class="input-field" 
          type="{{showPassword ? 'text' : 'password'}}" 
          placeholder="请输入新密码（至少6位）" 
          value="{{newPassword}}"
          bindinput="onNewPasswordInput"
        />
        <view class="input-action" bindtap="togglePasswordShow">
          <l-icon name="{{showPassword ? 'eye' : 'eye-close'}}" size="40" color="#999"></l-icon>
        </view>
      </view>
    </view>

    <!-- 确认密码 -->
    <view class="input-group">
      <view class="input-wrapper">
        <view class="input-icon">
          <l-icon name="lock" size="40" color="#999"></l-icon>
        </view>
        <input 
          class="input-field" 
          type="{{showConfirmPassword ? 'text' : 'password'}}" 
          placeholder="请再次输入新密码" 
          value="{{confirmPassword}}"
          bindinput="onConfirmPasswordInput"
        />
        <view class="input-action" bindtap="toggleConfirmPasswordShow">
          <l-icon name="{{showConfirmPassword ? 'eye' : 'eye-close'}}" size="40" color="#999"></l-icon>
        </view>
      </view>
    </view>

    <!-- 重置按钮 -->
    <view class="btn-wrapper">
      <l-button 
        class="primary-btn"
        type="success"
        size="large"
        loading="{{loading}}"
        bind:lintap="resetPassword"
      >
        {{loading ? '重置中...' : '完成重置'}}
      </l-button>
    </view>
  </view>

  <!-- 返回登录 -->
  <view class="back-section">
    <text class="back-text" bindtap="goLogin">返回登录</text>
  </view>
</view>